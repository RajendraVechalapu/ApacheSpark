{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470565782163_1473412089","id":"20160807-102942_1000722097","dateCreated":"Aug 7, 2016 10:29:42 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1515","text":"1+2","dateUpdated":"Aug 7, 2016 10:29:46 AM","dateFinished":"Aug 7, 2016 10:31:59 AM","dateStarted":"Aug 7, 2016 10:29:46 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"res0: Int = 3\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470565786615_1100605729","id":"20160807-102946_1203544119","dateCreated":"Aug 7, 2016 10:29:46 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1534","dateUpdated":"Aug 7, 2016 10:50:42 AM","dateFinished":"Aug 7, 2016 10:50:46 AM","dateStarted":"Aug 7, 2016 10:50:42 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark._\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.sql.hive.HiveContext\n"},"text":"import org.apache.spark._\r\nimport org.apache.spark.SparkContext._\r\nimport org.apache.spark.sql.hive.HiveContext"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470566626823_-2073780657","id":"20160807-104346_72158533","dateCreated":"Aug 7, 2016 10:43:46 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1555","dateUpdated":"Aug 7, 2016 10:52:07 AM","dateFinished":"Aug 7, 2016 10:52:17 AM","dateStarted":"Aug 7, 2016 10:52:07 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"hiveCtx: org.apache.spark.sql.hive.HiveContext = org.apache.spark.sql.hive.HiveContext@3762b0e6\nimport hiveCtx.implicits._\n"},"text":"val hiveCtx = new HiveContext(sc)\nimport hiveCtx.implicits._"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470566879952_-571368495","id":"20160807-104759_292449305","dateCreated":"Aug 7, 2016 10:47:59 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1576","dateUpdated":"Aug 7, 2016 11:02:45 AM","dateFinished":"Aug 7, 2016 10:56:13 AM","dateStarted":"Aug 7, 2016 10:55:39 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"warning: there were 1 deprecation warning(s); re-run with -deprecation for details\ninput: org.apache.spark.sql.DataFrame = [contributorsIDs: array<string>, createdAt: string, currentUserRetweetId: bigint, hashtagEntities: array<string>, id: bigint, inReplyToStatusId: bigint, inReplyToUserId: bigint, isFavorited: boolean, isPossiblySensitive: boolean, isTruncated: boolean, mediaEntities: array<string>, retweetCount: bigint, source: string, text: string, urlEntities: array<string>, user: struct<createdAt:string,description:string,descriptionURLEntities:array<string>,favouritesCount:bigint,followersCount:bigint,friendsCount:bigint,id:bigint,isContributorsEnabled:boolean,isFollowRequestSent:boolean,isGeoEnabled:boolean,isProtected:boolean,isVerified:boolean,lang:string,listedCount:bigint,location:string,name:string,profileBackgroundColor:string,profileBackgroundImageUrl:s..."},"text":"// Load some tweets\nval input = hiveCtx.jsonFile(\"/tmp/testweet.json\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470567210653_2083862453","id":"20160807-105330_288075606","dateCreated":"Aug 7, 2016 10:53:30 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1614","dateUpdated":"Aug 7, 2016 11:02:59 AM","dateFinished":"Aug 7, 2016 11:03:01 AM","dateStarted":"Aug 7, 2016 11:03:00 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- contributorsIDs: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- createdAt: string (nullable = true)\n |-- currentUserRetweetId: long (nullable = true)\n |-- hashtagEntities: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- id: long (nullable = true)\n |-- inReplyToStatusId: long (nullable = true)\n |-- inReplyToUserId: long (nullable = true)\n |-- isFavorited: boolean (nullable = true)\n |-- isPossiblySensitive: boolean (nullable = true)\n |-- isTruncated: boolean (nullable = true)\n |-- mediaEntities: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- retweetCount: long (nullable = true)\n |-- source: string (nullable = true)\n |-- text: string (nullable = true)\n |-- urlEntities: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- user: struct (nullable = true)\n |    |-- createdAt: string (nullable = true)\n |    |-- description: string (nullable = true)\n |    |-- descriptionURLEntities: array (nullable = true)\n |    |    |-- element: string (containsNull = true)\n |    |-- favouritesCount: long (nullable = true)\n |    |-- followersCount: long (nullable = true)\n |    |-- friendsCount: long (nullable = true)\n |    |-- id: long (nullable = true)\n |    |-- isContributorsEnabled: boolean (nullable = true)\n |    |-- isFollowRequestSent: boolean (nullable = true)\n |    |-- isGeoEnabled: boolean (nullable = true)\n |    |-- isProtected: boolean (nullable = true)\n |    |-- isVerified: boolean (nullable = true)\n |    |-- lang: string (nullable = true)\n |    |-- listedCount: long (nullable = true)\n |    |-- location: string (nullable = true)\n |    |-- name: string (nullable = true)\n |    |-- profileBackgroundColor: string (nullable = true)\n |    |-- profileBackgroundImageUrl: string (nullable = true)\n |    |-- profileBackgroundImageUrlHttps: string (nullable = true)\n |    |-- profileBackgroundTiled: boolean (nullable = true)\n |    |-- profileBannerImageUrl: string (nullable = true)\n |    |-- profileImageUrl: string (nullable = true)\n |    |-- profileImageUrlHttps: string (nullable = true)\n |    |-- profileLinkColor: string (nullable = true)\n |    |-- profileSidebarBorderColor: string (nullable = true)\n |    |-- profileSidebarFillColor: string (nullable = true)\n |    |-- profileTextColor: string (nullable = true)\n |    |-- profileUseBackgroundImage: boolean (nullable = true)\n |    |-- screenName: string (nullable = true)\n |    |-- showAllInlineMedia: boolean (nullable = true)\n |    |-- statusesCount: long (nullable = true)\n |    |-- translator: boolean (nullable = true)\n |    |-- utcOffset: long (nullable = true)\n |-- userMentionEntities: array (nullable = true)\n |    |-- element: string (containsNull = true)\n\n"},"text":"// Print the schema\r\n      input.printSchema()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470567295565_-1564236317","id":"20160807-105455_1962963974","dateCreated":"Aug 7, 2016 10:54:55 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1645","dateUpdated":"Aug 7, 2016 11:03:38 AM","dateFinished":"Aug 7, 2016 11:03:38 AM","dateStarted":"Aug 7, 2016 11:03:38 AM","result":{"code":"SUCCESS","type":"TEXT","msg":""},"text":"      // Register the input schema RDD\r\n      input.registerTempTable(\"tweets\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470567758111_893631602","id":"20160807-110238_1048885787","dateCreated":"Aug 7, 2016 11:02:38 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1682","dateUpdated":"Aug 7, 2016 11:03:55 AM","dateFinished":"Aug 7, 2016 11:03:58 AM","dateStarted":"Aug 7, 2016 11:03:55 AM","result":{"code":"SUCCESS","type":"TEXT","msg":""},"text":" hiveCtx.cacheTable(\"tweets\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470567835600_-156843453","id":"20160807-110355_2113472733","dateCreated":"Aug 7, 2016 11:03:55 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1717","dateUpdated":"Aug 7, 2016 11:04:45 AM","dateFinished":"Aug 7, 2016 11:05:05 AM","dateStarted":"Aug 7, 2016 11:04:45 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"topTweets: org.apache.spark.sql.DataFrame = [text: string, retweetCount: bigint]\n[Adventures With Coffee, Code, and Writing.,0]\nres24: Array[Unit] = Array(())\ntopTweetText: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[25] at map at <console>:51\n"},"text":"// Select tweets based on the retweetCount\r\n      val topTweets = hiveCtx.sql(\"SELECT text, retweetCount FROM tweets ORDER BY retweetCount LIMIT 10\")\r\n      topTweets.collect().map(println(_))\r\n      val topTweetText = topTweets.map(row => row.getString(0))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470567885736_-1812925313","id":"20160807-110445_2097263466","dateCreated":"Aug 7, 2016 11:04:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1740","dateUpdated":"Aug 7, 2016 11:05:49 AM","dateFinished":"Aug 7, 2016 11:05:54 AM","dateStarted":"Aug 7, 2016 11:05:50 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"defined class HappyPerson\n"},"text":"case class HappyPerson(handle: String, favouriteBeverage: String)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470567949998_645928287","id":"20160807-110549_1332592416","dateCreated":"Aug 7, 2016 11:05:49 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1769","dateUpdated":"Aug 7, 2016 11:06:23 AM","dateFinished":"Aug 7, 2016 11:06:27 AM","dateStarted":"Aug 7, 2016 11:06:23 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"happyPeopleRDD: org.apache.spark.sql.DataFrame = [handle: string, favouriteBeverage: string]\n"},"text":"// Create a person and turn it into a Schema RDD\r\n      val happyPeopleRDD = sc.parallelize(List(HappyPerson(\"holden\", \"coffee\"))).toDF()\r\n      happyPeopleRDD.registerTempTable(\"happy_people\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470567983174_-2051130855","id":"20160807-110623_682936208","dateCreated":"Aug 7, 2016 11:06:23 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1790","dateUpdated":"Aug 7, 2016 11:07:00 AM","dateFinished":"Aug 7, 2016 11:07:07 AM","dateStarted":"Aug 7, 2016 11:07:00 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"res31: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,IntegerType,List(StringType))\ntweetLength: org.apache.spark.sql.DataFrame = [_c0: int]\n[5]\nres32: Array[Unit] = Array(())\n"},"text":"// UDF\r\n      hiveCtx.udf.register(\"strLenScala\", (_: String).length)\r\n      val tweetLength = hiveCtx.sql(\"SELECT strLenScala('tweet') FROM tweets LIMIT 10\")\r\n      tweetLength.collect().map(println(_))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470568020039_-1307933897","id":"20160807-110700_107545696","dateCreated":"Aug 7, 2016 11:07:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1813","dateUpdated":"Aug 7, 2016 11:07:46 AM","dateFinished":"Aug 7, 2016 11:07:57 AM","dateStarted":"Aug 7, 2016 11:07:46 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"twoSums: org.apache.spark.sql.DataFrame = [_c0: bigint, _c1: bigint, id: bigint]\n[1095,0,15594928]\nres35: Array[Unit] = Array(())\n"},"text":"// Two sums at once (crazy town!)\r\n      val twoSums = hiveCtx.sql(\"SELECT SUM(user.favouritesCount), SUM(retweetCount), user.id FROM tweets GROUP BY user.id LIMIT 10\")\r\n      twoSums.collect().map(println(_))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470568066398_-612231265","id":"20160807-110746_1777578225","dateCreated":"Aug 7, 2016 11:07:46 AM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1838"}],"name":"Rajendra_SparkSQLTwitter","id":"2BRXDCGRE","angularObjects":{"2BJTPD256":[],"2BHHB7JC4":[],"2BHDPF6W5":[],"2BH96FAY4":[],"2BKS3B7FE":[],"2BJQNH8PY":[],"2BGPKR7MK":[],"2BGKF6CBT":[],"2BJJKYFTH":[],"2BH1161XB":[],"2BJCQS1G5":[],"2BHJ6G4KH":[],"2BHEXH1U2":[]},"config":{"looknfeel":"default"},"info":{}}